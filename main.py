import streamlit as st
import pandas as pd

def ì •ì œ_ì—´ì´ë¦„(df, ì ‘ë‘ì‚¬):
    """ì—´ ì´ë¦„ì—ì„œ ì ‘ë‘ì‚¬ ì œê±°í•˜ê³  ë‚˜ì´ë§Œ ë‚¨ê¸°ê¸°"""
    ìƒˆë¡œìš´_ì—´ = []
    for ì—´ in df.columns:
        if ì—´.startswith(ì ‘ë‘ì‚¬):
            label = ì—´.replace(ì ‘ë‘ì‚¬, '')
            if 'ì´ì¸êµ¬ìˆ˜' in label:
                ìƒˆë¡œìš´_ì—´.append('ì´ì¸êµ¬ìˆ˜')
            elif 'ì—°ë ¹êµ¬ê°„ì¸êµ¬ìˆ˜' in label:
                ìƒˆë¡œìš´_ì—´.append('ì—°ë ¹êµ¬ê°„ì¸êµ¬ìˆ˜')
            else:
                ìƒˆë¡œìš´_ì—´.append(label)
        else:
            ìƒˆë¡œìš´_ì—´.append(ì—´)
    df.columns = ìƒˆë¡œìš´_ì—´
    return df

def ìˆ«ì_í˜•ë³€í™˜(df):
    """ì‰¼í‘œ ì œê±° í›„ ìˆ«ìí˜• ë³€í™˜"""
    ìˆ«ìì—´ = [ì—´ for ì—´ in df.columns if ì—´ != 'í–‰ì •êµ¬ì—­']
    for ì—´ in ìˆ«ìì—´:
        df[ì—´] = df[ì—´].astype(str).str.replace(',', '', regex=False).astype(int)
    return df

def app():
    st.title("ğŸ“Š ëŒ€í•œë¯¼êµ­ ì—°ë ¹ëŒ€ë³„ ì¸êµ¬ ë¶„í¬ (ìƒìœ„ 5ê°œ í–‰ì •êµ¬ì—­ ê¸°ì¤€)")

    # â¬‡ï¸ ì „ì²´ ì¸êµ¬ íŒŒì¼
    df_ì „ì²´ = pd.read_csv('202505_202505_ì—°ë ¹ë³„ì¸êµ¬í˜„í™©_ì›”ê°„.csv', encoding='euc-kr')
    df_ì „ì²´['í–‰ì •êµ¬ì—­'] = df_ì „ì²´['í–‰ì •êµ¬ì—­'].astype(str).str.split(' ').str[0]
    df_ì „ì²´ = ì •ì œ_ì—´ì´ë¦„(df_ì „ì²´, '2025ë…„05ì›”_ê³„_')
    df_ì „ì²´ = ìˆ«ì_í˜•ë³€í™˜(df_ì „ì²´)

    # â¬‡ï¸ ì„±ë³„ ì¸êµ¬ íŒŒì¼
    df_ì„±ë³„ = pd.read_csv('202505_202505_ì—°ë ¹ë³„ì¸êµ¬í˜„í™©_ì›”ê°„ (1).csv', encoding='euc-kr')
    df_ì„±ë³„['í–‰ì •êµ¬ì—­'] = df_ì„±ë³„['í–‰ì •êµ¬ì—­'].astype(str).str.split(' ').str[0]

    # ì—´ ì´ë¦„ ì •ì œ (ë‚¨/ì—¬)
    ì—´ëª©ë¡ = []
    for ì—´ in df_ì„±ë³„.columns:
        if ì—´.startswith('2025ë…„05ì›”_ë‚¨_'):
            ì—´ëª©ë¡.append('ë‚¨_' + ì—´.replace('2025ë…„05ì›”_ë‚¨_', ''))
        elif ì—´.startswith('2025ë…„05ì›”
